MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;************************************************************************
                      00002 ;*      Microchip Technology Inc. 2002                                  *
                      00003 ;*      Assembler version: 2.0000                                       *
                      00004 ;*      Filename:                                                       *
                      00005 ;*              lcd16.asm                                               *
                      00006 ;************************************************************************
                      00007 
                      00008         list            p=16F877A
                      00009         #include        P16F877A.inc
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F877A processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2011 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00564         LIST
                      00010 
                      00011 #define LCD_D4          PORTD, 0        ; LCD data bits
                      00012 
                      00013 #define LCD_D5          PORTD, 1    ; LCD_D5 est associé  à port PORTD byte 1
                      00014 #define LCD_D6          PORTD, 2     
                      00015 #define LCD_D7          PORTD, 3
                      00016 
                      00017 #define LCD_D4_DIR      TRISD, 0        ; LCD data bits , bite 0
                      00018 #define LCD_D5_DIR      TRISD, 1        ; pour savoir si c'est une entrée ou une sortie , bite 1
                      00019 #define LCD_D6_DIR      TRISD, 2        ; bite 2
                      00020 #define LCD_D7_DIR      TRISD, 3        ; bite 3
                      00021         
                      00022 #define LCD_E           PORTD, 6        ; LCD E clock
                      00023 #define LCD_RW          PORTD, 5        ; LCD read/write line
                      00024 #define LCD_RS          PORTD, 4        ; LCD register select line
                      00025 
                      00026 #define LCD_E_DIR       TRISD, 6        ; définition de constantes
                      00027 #define LCD_RW_DIR      TRISD, 5        ; définition de constantes
                      00028 #define LCD_RS_DIR      TRISD, 4        ; définition de constantes
                      00029 
                      00030 #define LCD_INS         0       
                      00031 #define LCD_DATA        1
                      00032 
                      00033 
                      00034 
                      00035 D_LCD_DATA      UDATA 0x20
0020                  00036 COUNTER         res     1  ; permet de réserver le nombre de case en mémoire
0021                  00037 delay           res     1
0022                  00038 temp_wr         res     1
0023                  00039 temp_rd         res     1
                      00040 
  0000                00041         GLOBAL  temp_wr  ; variable globale peut être. ??????????????
                      00042 
                      00043 PROG1   CODE 
                      00044 
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00045 
                      00046 ;***************************************************************************
                      00047         
0000                  00048 LCDLine_1
0000   ???? ????      00049         banksel temp_wr         ; action qui permet de changer de banque. On va dans la banque temp_wr 
0002   3080           00050         movlw   0x80            ; initialisation d'un pointeur
0003   00??           00051         movwf   temp_wr         ; le registre w et déplacé dans le registre f
0004   2???           00052         call    i_write         ; appel de i_write
0005   0008           00053         return                          ;Au retour d'un sous programme, le compteur ordinal est chargé p
                            ar l'adresse sauvegardé dans la pile ( adresse de retour).      
  0000                00054         GLOBAL  LCDLine_1
                      00055 
0006                  00056 LCDLine_2
0006   ???? ????      00057         banksel temp_wr  ; changement de banque
0008   30C0           00058         movlw   0xC0     ; les huit bits de la donnée littérale sont chargées dans le registre w
0009   00??           00059         movwf   temp_wr  ; contenu de w mis dans f
000A   2???           00060         call    i_write  ; on appel i_write
000B   0008           00061         return
  0000                00062         GLOBAL  LCDLine_2
                      00063         
000C                  00064 d_write                                 ;write data
000C   2???           00065         call    LCDBusy     ; appel LCD busy
000D   1403           00066         bsf     STATUS, C               ; le bit de position C du registre Status (qui permet de changer
                             de banque) est mis à 1
000E   2???           00067         call    LCDWrite    ; appel de LCDWrite
000F   1283 1303      00068         banksel TXREG           ;move data into TXREG 
0011   0099           00069         movwf   TXREG
0012   1683 1303      00070         banksel TXSTA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0014   1C98           00071         btfss   TXSTA,TRMT  ; test du bit TMRA du registre TXSTA
0015   2???           00072         goto    $-1             ; si ce bit est a 0, on va à $-1
0016   1283 1303      00073         banksel PORTA           ; changement de bnque , passag en banque 0 
0018   0008           00074         return                          ; return
  0000                00075         GLOBAL  d_write      
                      00076         
0019                  00077 i_write                                 ;write instruction
0019   2???           00078         call    LCDBusy     ; appel de LCDBusy
001A   1003           00079          bcf    STATUS, C   ;  remise a zéro du byte C de status
001B   2???           00080         call    LCDWrite        ; appel de LCDWrite
001C   0008           00081         return                          ;return
  0000                00082         GLOBAL  i_write         ;
                      00083 
                      00084 rlcd    macro   MYREGISTER
                      00085  IF MYREGISTER == 1   ;si my register ==1
                      00086 bsf     STATUS, C               ;  le bit C de status est mis  1
                      00087         call    LCDRead  ; appel de LCDRead
                      00088  ELSE
                      00089         bcf     STATUS, C       ; le bit c de status est mis a 0
                      00090         call    LCDRead     ; appel lcdread
                      00091  ENDIF                                  ;????
                      00092         endm                            ;?????
                      00093 ;****************************************************************************
                      00094 
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00095 
                      00096 
                      00097 
                      00098 ; *******************************************************************
001D                  00099 LCDInit                         ;Initialisation 
                      00100 
001D   1683 1303      00101         banksel TRISD           ; changement de banque (banque1) 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001F   1388           00102         bcf             TRISD,7         ; bit 7 mise a 0 du registre TRISD
0020   1283 1303      00103         banksel PORTD           ; changement de banque (banque0)
0022   1788           00104         bsf             PORTD,7         ; bit de port D mis a 1
0023   2???           00105         call    Delay30ms       ; appel d'un délai (met en pause le programme) délai de 30ms
0024   0185           00106         clrf    PORTA           ;le port A est mis a 0
                      00107         
0025   1683 1303      00108         banksel TRISA           ;configure control lines passage en banque 1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0027   1308           00109         bcf     LCD_E_DIR               ; mise a zéro de LCD_E_DIR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0028   1288           00110         bcf     LCD_RW_DIR              ;mise à zéro de  LCD_E_DIR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0029   1208           00111         bcf     LCD_RS_DIR              ; mise a zéro LCD_RS_DIR
                      00112         
002A   300E           00113         movlw   b'00001110'    ; les 8 bits de la donnée littérale sont chargés dans le registre W  
002B   1683 1303      00114         banksel ADCON1                  ; changement de banque  (banque1)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002D   009F           00115         movwf   ADCON1                  ; contenu du registre w est placé dans ADCON1
                      00116 
002E   30FF           00117         movlw   0xff                    ; Wait ~15ms @ 20 MHz  Les 8 bits de la donnée littérale sont ch
                            argés dans le registre W.
002F   ???? ????      00118         banksel COUNTER
0031   00??           00119         movwf   COUNTER
0032   30FF           00120         movlw   0xFF
0033   ???? ????      00121         banksel delay
0035   00??           00122         movwf   delay
0036   2???           00123         call    DelayXCycles
0037   0B??           00124         decfsz  COUNTER, F
0038   2???           00125         goto    $-3
                      00126 ;0x02------------------ 
                      00127 ;       movlw   b'00110000'             ;#1 Send control sequence 
0039   3020           00128         movlw   b'00100000'             ;#1 Send control sequence 
003A   00??           00129         movwf   temp_wr
003B   1003           00130         bcf     STATUS,C
003C   2???           00131         call    LCDWriteNibble
                      00132 
003D   30FF           00133         movlw   0xff                    ;Wait ~4ms @ 20 MHz
003E   00??           00134         movwf   COUNTER
003F   30FF           00135         movlw   0xFF
0040   00??           00136         movwf   delay
0041   2???           00137         call    DelayXCycles
0042   0B??           00138         decfsz  COUNTER, F
0043   2???           00139         goto    $-3
                      00140 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00141 ;28---2
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00142 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00143 ;       movlw   b'00110000'             ;#2 Send control sequence
0044   3020           00144         movlw   b'00100000'             ;#2 Send control sequence
0045   00??           00145         movwf   temp_wr
0046   1003           00146         bcf     STATUS,C
0047   2???           00147         call    LCDWriteNibble
                      00148 
0048   30FF           00149         movlw   0xFF                    ;Wait ~100us @ 20 MHz
0049   00??           00150         movwf   delay
004A   2???           00151         call    DelayXCycles
                      00152 ;28--08                                         
                      00153 ;       movlw   b'0011000'              ;#3 Send control sequence
004B   3080           00154         movlw   b'10000000'
004C   00??           00155         movwf   temp_wr
004D   1003           00156         bcf     STATUS,C
004E   2???           00157         call    LCDWriteNibble
                      00158 
                      00159                 ;test delay
004F   30FF           00160         movlw   0xFF                    ;Wait ~100us @ 20 MHz
0050   00??           00161         movwf   delay
0051   2???           00162         call    DelayXCycles
                      00163 
                      00164 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00165 ;0C--0
                      00166 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00167 
                      00168 ;       movlw   b'00100000'             ;#4 set 4-bit
0052   3000           00169         movlw   b'00000000'             ;#4 set 4-bit
0053   00??           00170         movwf   temp_wr
0054   1003           00171         bcf     STATUS,C
0055   2???           00172         call    LCDWriteNibble
                      00173 ;0x0C
0056   30C0           00174         movlw   b'11000000'             ;#4 set 4-bit
0057   00??           00175         movwf   temp_wr
0058   1003           00176         bcf     STATUS,C
0059   2???           00177         call    LCDWriteNibble
                      00178 
                      00179 
                      00180 
005A   2???           00181         call    Delay1ms
                      00182 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00183 ;0x01
                      00184 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00185 ;       movlw   b'00100000'             ;#4 set 4-bit
005B   3000           00186         movlw   b'00000000'             ;#4 set 4-bit
005C   00??           00187         movwf   temp_wr
005D   1003           00188         bcf     STATUS,C
005E   2???           00189         call    LCDWriteNibble
                      00190 ;0x01
005F   3010           00191         movlw   b'00010000'             ;#4 set 4-bit
0060   00??           00192         movwf   temp_wr
0061   1003           00193         bcf     STATUS,C
0062   2???           00194         call    LCDWriteNibble
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00195 
                      00196 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0063   2???           00197         call    LongDelay ;2ms
0064   2???           00198         call    LongDelay ;2ms
0065   2???           00199         call    LongDelay ;2ms
0066   2???           00200         call    LongDelay ;2ms
                      00201 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00202 ;0x02
                      00203 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0067   3000           00204         movlw   b'00000000'             ;#4 set 4-bit
0068   00??           00205         movwf   temp_wr
0069   1003           00206         bcf     STATUS,C
006A   2???           00207         call    LCDWriteNibble
                      00208 ;0x02
006B   3020           00209         movlw   b'00100000'             ;#4 set 4-bit
006C   00??           00210         movwf   temp_wr
006D   1003           00211         bcf     STATUS,C
006E   2???           00212         call    LCDWriteNibble
                      00213 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00214 ;       rcall   LCDBusy                 ;Busy?
006F   2???           00215         call    LongDelay ;2ms
0070   2???           00216         call    LongDelay ;2ms
0071   2???           00217         call    LongDelay ;2ms
0072   2???           00218         call    LongDelay ;2ms
0073   2???           00219         call    LongDelay ;2ms
0074   2???           00220         call    LongDelay ;2ms
0075   2???           00221         call    LongDelay ;2ms
                      00222 
                      00223 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00224 
                      00225 
                      00226 ;       call    LCDBusy                 ;Busy?
                      00227 ;                               
                      00228 ;       movlw   b'00101000'             ;#5   Function set
                      00229 ;       movwf   temp_wr
                      00230 ;       call    i_write
                      00231 ;
                      00232 ;       movlw   b'00001101'             ;#6  Display = ON
                      00233 ;       movwf   temp_wr
                      00234 ;       call    i_write
                      00235 ;                       
                      00236 ;       movlw   b'00000001'             ;#7   Display Clear
                      00237 ;       movwf   temp_wr
                      00238 ;       call    i_write
                      00239 ;
                      00240 ;       movlw   b'00000110'             ;#8   Entry Mode
                      00241 ;       movwf   temp_wr
                      00242 ;       call    i_write 
                      00243 ;
                      00244 ;       movlw   b'10000000'             ;DDRAM addresss 0000
                      00245 ;       movwf   temp_wr
                      00246 ;       call    i_write
                      00247 
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00248 ;       movlw   b'00000010'             ;return home
                      00249 ;       movwf   temp_wr
                      00250 ;       call    i_write
                      00251 
0076   304E           00252         movlw   0x4E
0077   00??           00253         movwf   temp_wr
0078   2???           00254         call    LCDBusy
0079   1403           00255         bsf     STATUS, C       
007A   2???           00256         call    LCDWrite
                      00257 
                      00258 
007B   2???           00259         call    Delay1ms
007C   0008           00260         return
                      00261 
  0000                00262         GLOBAL  LCDInit 
                      00263 ; *******************************************************************
                      00264 
                      00265 
                      00266 
                      00267 
                      00268 
                      00269 
                      00270 
                      00271 
                      00272 ;****************************************************************************
                      00273 ;     _    ______________________________
                      00274 ; RS  _>--<______________________________
                      00275 ;     _____
                      00276 ; RW       \_____________________________
                      00277 ;                  __________________
                      00278 ; E   ____________/                  \___
                      00279 ;     _____________                ______
                      00280 ; DB  _____________>--------------<______
                      00281 ;
007D                  00282 LCDWriteNibble
007D   1C03           00283         btfss   STATUS, C               ; Set the register select
007E   1208           00284         bcf     LCD_RS
007F   1803           00285         btfsc   STATUS, C       
0080   1608           00286         bsf     LCD_RS
                      00287 
0081   1288           00288         bcf     LCD_RW                  ; Set write mode
                      00289 
0082   1683 1303      00290         banksel TRISD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0084   1008           00291         bcf     LCD_D4_DIR              ; Set data bits to outputs
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0085   1088           00292         bcf     LCD_D5_DIR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0086   1108           00293         bcf     LCD_D6_DIR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0087   1188           00294         bcf     LCD_D7_DIR
                      00295 
0088   0000           00296         NOP                             ; Small delay
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0089   0000           00297         NOP
                      00298 
008A   1283 1303      00299         banksel PORTA
008C   1708           00300         bsf     LCD_E                   ; Setup to clock data
                      00301         
008D   1F80           00302         btfss   temp_wr, 7                      ; Set high nibble
008E   1188           00303         bcf     LCD_D7  
008F   1B80           00304         btfsc   temp_wr, 7
0090   1588           00305         bsf     LCD_D7
0091   1F00           00306         btfss   temp_wr, 6
0092   1108           00307         bcf     LCD_D6  
0093   1B00           00308         btfsc   temp_wr, 6
0094   1508           00309         bsf     LCD_D6
0095   1E80           00310         btfss   temp_wr, 5
0096   1088           00311         bcf     LCD_D5  
0097   1A80           00312         btfsc   temp_wr, 5
0098   1488           00313         bsf     LCD_D5
0099   1E00           00314         btfss   temp_wr, 4
009A   1008           00315         bcf     LCD_D4
009B   1A00           00316         btfsc   temp_wr, 4
009C   1408           00317         bsf     LCD_D4  
                      00318 
009D   0000           00319         NOP
009E   0000           00320         NOP
                      00321 
009F   1308           00322         bcf     LCD_E                   ; Send the data
                      00323 
00A0   0008           00324         return
                      00325 ; *******************************************************************
                      00326 
                      00327 
                      00328 
                      00329 
                      00330 
                      00331 ; *******************************************************************
00A1                  00332 LCDWrite
                      00333 ;       call    LCDBusy
00A1   2???           00334         call    LCDWriteNibble
00A2   ???? ????      00335         BANKSEL temp_wr
00A4   0E??           00336         swapf   temp_wr, f
00A5   2???           00337         call    LCDWriteNibble
00A6   ???? ????      00338         banksel temp_wr
00A8   0E??           00339         swapf   temp_wr,f
                      00340 
00A9   0008           00341         return
                      00342 
  0000                00343         GLOBAL  LCDWrite
                      00344 ; *******************************************************************
                      00345 
                      00346 
                      00347 
                      00348 
                      00349 
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00350 ; *******************************************************************
                      00351 ;     _____    _____________________________________________________
                      00352 ; RS  _____>--<_____________________________________________________
                      00353 ;               ____________________________________________________
                      00354 ; RW  _________/
                      00355 ;                  ____________________      ____________________
                      00356 ; E   ____________/                    \____/                    \__
                      00357 ;     _________________                __________                ___
                      00358 ; DB  _________________>--------------<__________>--------------<___
                      00359 ;
00AA                  00360 LCDRead
00AA   1683 1303      00361         banksel TRISD
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00AC   1408           00362         bsf     LCD_D4_DIR              ; Set data bits to inputs
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00AD   1488           00363         bsf     LCD_D5_DIR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00AE   1508           00364         bsf     LCD_D6_DIR
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00AF   1588           00365         bsf     LCD_D7_DIR              
                      00366 
00B0   1283 1303      00367         BANKSEL PORTA
00B2   1C03           00368         btfss   STATUS, C               ; Set the register select
00B3   1208           00369         bcf     LCD_RS
00B4   1803           00370         btfsc   STATUS, C       
00B5   1608           00371         bsf     LCD_RS
                      00372 
00B6   1688           00373         bsf     LCD_RW                  ;Read = 1
                      00374 
00B7   0000           00375         NOP
00B8   0000           00376         NOP                     
                      00377 
00B9   1708           00378         bsf     LCD_E                   ; Setup to clock data
                      00379 
00BA   0000           00380         NOP
00BB   0000           00381         NOP
00BC   0000           00382         NOP
00BD   0000           00383         NOP
                      00384 
00BE   1D88           00385         btfss   LCD_D7                  ; Get high nibble
00BF   1380           00386         bcf     temp_rd, 7
00C0   1988           00387         btfsc   LCD_D7
00C1   1780           00388         bsf     temp_rd, 7
00C2   1D08           00389         btfss   LCD_D6                  
00C3   1300           00390         bcf     temp_rd, 6
00C4   1908           00391         btfsc   LCD_D6
00C5   1700           00392         bsf     temp_rd, 6
00C6   1C88           00393         btfss   LCD_D5                  
00C7   1280           00394         bcf     temp_rd, 5
00C8   1888           00395         btfsc   LCD_D5
00C9   1680           00396         bsf     temp_rd, 5
00CA   1C08           00397         btfss   LCD_D4                  
00CB   1200           00398         bcf     temp_rd, 4
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00CC   1808           00399         btfsc   LCD_D4
00CD   1600           00400         bsf     temp_rd, 4
                      00401 
00CE   1308           00402         bcf     LCD_E                   ; Finished reading the data
                      00403 
00CF   0000           00404         NOP
00D0   0000           00405         NOP
00D1   0000           00406         NOP
00D2   0000           00407         NOP
00D3   0000           00408         NOP
00D4   0000           00409         NOP
00D5   0000           00410         NOP
00D6   0000           00411         NOP
                      00412 
00D7   1708           00413         bsf     LCD_E                   ; Setup to clock data
                      00414 
00D8   0000           00415         NOP
00D9   0000           00416         NOP
                      00417 
00DA   1D88           00418         btfss   LCD_D7                  ; Get low nibble
00DB   1180           00419         bcf     temp_rd, 3
00DC   1988           00420         btfsc   LCD_D7
00DD   1580           00421         bsf     temp_rd, 3
00DE   1D08           00422         btfss   LCD_D6                  
00DF   1100           00423         bcf     temp_rd, 2
00E0   1908           00424         btfsc   LCD_D6
00E1   1500           00425         bsf     temp_rd, 2
00E2   1C88           00426         btfss   LCD_D5                  
00E3   1080           00427         bcf     temp_rd, 1
00E4   1888           00428         btfsc   LCD_D5
00E5   1480           00429         bsf     temp_rd, 1
00E6   1C08           00430         btfss   LCD_D4                  
00E7   1000           00431         bcf     temp_rd, 0
00E8   1808           00432         btfsc   LCD_D4
00E9   1400           00433         bsf     temp_rd, 0
                      00434 
00EA   1308           00435         bcf     LCD_E                   ; Finished reading the data
                      00436 
00EB                  00437 FinRd
00EB   0008           00438         return
                      00439 ; *******************************************************************
                      00440 
                      00441 
                      00442 
                      00443 
                      00444 
                      00445 
                      00446 ; *******************************************************************
00EC                  00447 LCDBusy
00EC   2???           00448         call    LongDelayLast
                      00449 ;       call    LongDelay
00ED   0008           00450         return
                      00451                                 ; Check BF
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00452         rlcd    LCD_INS
                          M  IF 0          == 1   ;si my register ==1
                          M bsf     STATUS, C               ;  le bit C de status est mis  1
                          M         call    LCDRead  ; appel de LCDRead
                          M  ELSE
00EE   1003               M         bcf     STATUS, C       ; le bit c de status est mis a 0
00EF   2???               M         call    LCDRead     ; appel lcdread
                          M  ENDIF                                  ;????
00F0   1B80           00453         btfsc   temp_rd, 7
00F1   2???           00454         goto    LCDBusy
00F2   0008           00455         return
                      00456 
  0000                00457         GLOBAL  LCDBusy
                      00458 ; *******************************************************************
                      00459 
                      00460 
                      00461 
                      00462 
                      00463 
                      00464 
                      00465 ; *******************************************************************
00F3                  00466 DelayXCycles
00F3   0B??           00467         decfsz  delay, F
00F4   2???           00468         goto    DelayXCycles
00F5   0008           00469         return
                      00470 ; *******************************************************************
                      00471         
00F6                  00472 Delay1ms                        ;Approxiamtely at 4Mhz
00F6   ???? ????      00473         banksel delay
00F8   01??           00474         clrf    delay
00F9                  00475 Delay_1
00F9   0000           00476         nop
Message[305]: Using default destination of 1 (file).
00FA   0B??           00477         decfsz  delay
00FB   2???           00478         goto    Delay_1
00FC   0008           00479         return
                      00480 
                      00481 
                      00482 
                      00483 
00FD                  00484 Delay30ms       ;more than 30 at 4 Mhz  
00FD   2???           00485         call    Delay1ms
00FE   2???           00486         call    Delay1ms
00FF   2???           00487         call    Delay1ms
0100   2???           00488         call    Delay1ms
0101   2???           00489         call    Delay1ms
0102   2???           00490         call    Delay1ms
0103   2???           00491         call    Delay1ms
0104   2???           00492         call    Delay1ms
0105   2???           00493         call    Delay1ms
0106   2???           00494         call    Delay1ms
0107   2???           00495         call    Delay1ms
0108   2???           00496         call    Delay1ms
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0109   2???           00497         call    Delay1ms
010A   2???           00498         call    Delay1ms
                      00499 
010B   2???           00500         call    Delay1ms
010C   2???           00501         call    Delay1ms
010D   2???           00502         call    Delay1ms
010E   2???           00503         call    Delay1ms
010F   2???           00504         call    Delay1ms
0110   2???           00505         call    Delay1ms
0111   2???           00506         call    Delay1ms
0112   2???           00507         call    Delay1ms
0113   2???           00508         call    Delay1ms
0114   2???           00509         call    Delay1ms
0115   2???           00510         call    Delay1ms
0116   2???           00511         call    Delay1ms
0117   2???           00512         call    Delay1ms
0118   2???           00513         call    Delay1ms
                      00514 
0119   2???           00515         call    Delay1ms
011A   2???           00516         call    Delay1ms
011B   2???           00517         call    Delay1ms
011C   2???           00518         call    Delay1ms
011D   2???           00519         call    Delay1ms
011E   2???           00520         call    Delay1ms
011F   2???           00521         call    Delay1ms
0120   2???           00522         call    Delay1ms
0121   2???           00523         call    Delay1ms
0122   2???           00524         call    Delay1ms
0123   2???           00525         call    Delay1ms
0124   2???           00526         call    Delay1ms
0125   2???           00527         call    Delay1ms
0126   2???           00528         call    Delay1ms
0127   0008           00529         return
0128                  00530 LongDelay:
0128   2???           00531         call    Delay1ms        
0129   2???           00532         call    Delay1ms
012A   2???           00533         call    Delay1ms
012B   2???           00534         call    Delay1ms
012C   2???           00535         call    Delay1ms
012D   2???           00536         call    Delay1ms
012E   2???           00537         call    Delay1ms
012F   2???           00538         call    Delay1ms
0130   2???           00539         call    Delay1ms
0131   0008           00540         return
                      00541 
0132                  00542 LongDelayLast
0132   2???           00543         call    Delay1ms
0133   2???           00544         call    Delay1ms
0134   2???           00545         call    Delay1ms
0135   0008           00546         return
                      00547 
                      00548         END
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 12


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 13


SYMBOL TABLE
  LABEL                             VALUE 

CKP                               00000004
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
COUNTER                           00000020
CREN                              00000004
CSRC                              00000007
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
D_A                               00000005
D_NOT_A                           00000005
Delay1ms                          000000F6
Delay30ms                         000000FD
DelayXCycles                      000000F3
Delay_1                           000000F9
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
F                                 00000001
FERR                              00000002
FSR                               00000004
FinRd                             000000EB
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INTCON                            0000000B
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
LCDBusy                           000000EC
LCDInit                           0000001D
LCDLine_1                         00000000
LCDLine_2                         00000006
LCDRead                           000000AA
LCDWrite                          000000A1
LCDWriteNibble                    0000007D
LCD_D4                            PORTD, 0
LCD_D4_DIR                        TRISD, 0
LCD_D5                            PORTD, 1
LCD_D5_DIR                        TRISD, 1
LCD_D6                            PORTD, 2
LCD_D6_DIR                        TRISD, 2
LCD_D7                            PORTD, 3
LCD_D7_DIR                        TRISD, 3
LCD_DATA                          1
LCD_E                             PORTD, 6
LCD_E_DIR                         TRISD, 6
LCD_INS                           0
LCD_RS                            PORTD, 4
LCD_RS_DIR                        TRISD, 4
LCD_RW                            PORTD, 5
LCD_RW_DIR                        TRISD, 5
LongDelay                         00000128
LongDelayLast                     00000132
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SEN                               00000000
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

T2CON                             00000012
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 18


SYMBOL TABLE
  LABEL                             VALUE 

TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_CP_ON                            00001FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PROG1_0015                       00000015
_PROG1_0038                       00000038
_PROG1_0043                       00000043
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
MPASM  5.43                        P16LCD.ASM   6-25-2013  11:15:17         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877A                         00000001
d_write                           0000000C
delay                             00000021
i_write                           00000019
rlcd                              
temp_rd                           00000023
temp_wr                           00000022

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    15 reported,     0 suppressed

